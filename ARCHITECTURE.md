# ZOOT é¡¹ç›®æ¶æ„è¯´æ˜

## ğŸ“š ç›®å½•æ¦‚è§ˆ

```
ZOOT/
â”œâ”€â”€ dist/                      # æ„å»ºè¾“å‡ºç›®å½•
â”œâ”€â”€ electron/                  # Electron ä¸»è¿›ç¨‹ä»£ç 
â”œâ”€â”€ package.json               # é¡¹ç›®é…ç½®å’Œä¾èµ–
â”œâ”€â”€ tsconfig.json            # TypeScript é…ç½®
â”œâ”€â”€ vite.config.ts          # Vite æ„å»ºé…ç½®
â”œâ”€â”€ electron-builder.yml     # Electron æ‰“åŒ…é…ç½®
â””â”€â”€ src/
    â”œâ”€â”€ main/                # Electron ä¸»è¿›ç¨‹
    â”‚   â”œâ”€â”€ index.ts       # ä¸»è¿›ç¨‹å…¥å£æ–‡ä»¶
    â”‚   â””â”€â”€ preload.ts    # é¢„åŠ è½½è„šæœ¬ï¼ˆä¸»è¿›ç¨‹ä¸æ¸²æŸ“è¿›ç¨‹çš„æ¡¥æ¢ï¼‰
    â”‚
    â””â”€â”€ renderer/           # æ¸²æŸ“è¿›ç¨‹ï¼ˆVue åº”ç”¨ï¼‰
        â”œâ”€â”€ main.ts        # åº”ç”¨å…¥å£
        â”œâ”€â”€ App.vue        # æ ¹ç»„ä»¶
        â”œâ”€â”€ assets/        # é™æ€èµ„æº
        â”œâ”€â”€ components/    # Vue ç»„ä»¶
        â”œâ”€â”€ composables/   # Vue ç»„åˆå¼å‡½æ•°
        â”œâ”€â”€ services/      # ä¸šåŠ¡æœåŠ¡å’Œ API
        â”œâ”€â”€ stores/        # çŠ¶æ€ç®¡ç†ï¼ˆPiniaï¼‰
        â”œâ”€â”€ styles/        # å…¨å±€æ ·å¼
        â”œâ”€â”€ types/         # TypeScript ç±»å‹å®šä¹‰
        â”œâ”€â”€ utils/         # å·¥å…·å‡½æ•°
        â””â”€â”€ test/          # æµ‹è¯•æ–‡ä»¶
```

---

## ğŸ“ è¯¦ç»†ç›®å½•è¯´æ˜

### `src/main/` - Electron ä¸»è¿›ç¨‹

#### `index.ts`
**ä½œç”¨ï¼š** Electron åº”ç”¨çš„ä¸»å…¥å£ç‚¹

**ä¸»è¦èŒè´£ï¼š**
- åˆ›å»ºåº”ç”¨çª—å£
- é…ç½®çª—å£å±æ€§ï¼ˆå¤§å°ã€å›¾æ ‡ç­‰ï¼‰
- å¤„ç†åº”ç”¨ç”Ÿå‘½å‘¨æœŸäº‹ä»¶
- æ³¨å†Œ IPC é€šä¿¡å¤„ç†å™¨

**å…³é”®ä»£ç ç¤ºä¾‹ï¼š**
```typescript
// åˆ›å»ºçª—å£
const mainWindow = new BrowserWindow({
  width: 1200,
  height: 800,
  webPreferences: {
    preload: path.join(__dirname, 'preload.js')
  }
});

// IPC é€šä¿¡
ipcMain.handle('api-request', async (event, options) => {
  // å¤„ç†æ¸²æŸ“è¿›ç¨‹çš„è¯·æ±‚
});
```

#### `preload.ts`
**ä½œç”¨ï¼š** è¿æ¥ä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹çš„æ¡¥æ¢

**ä¸»è¦èŒè´£ï¼š**
- é€šè¿‡ ContextBridge æš´éœ²å®‰å…¨çš„ API ç»™æ¸²æŸ“è¿›ç¨‹
- å®ç° IPC é€šä¿¡çš„åŒ…è£…
- æä¾›è·¨åŸŸè§£å†³æ–¹æ¡ˆ

**å…³é”®ä»£ç ç¤ºä¾‹ï¼š**
```typescript
// æš´éœ² API ç»™æ¸²æŸ“è¿›ç¨‹
contextBridge.exposeInMainWorld('api', {
  apiRequest: (options: any) => ipcRenderer.invoke('api-request', options)
});
```

---

### `src/renderer/` - Vue åº”ç”¨ï¼ˆæ¸²æŸ“è¿›ç¨‹ï¼‰

#### `main.ts`
**ä½œç”¨ï¼š** Vue åº”ç”¨çš„å…¥å£æ–‡ä»¶

**ä¸»è¦èŒè´£ï¼š**
- åˆ›å»º Vue åº”ç”¨å®ä¾‹
- æ³¨å†Œ Pinia stores
- æŒ‚è½½æ ¹ç»„ä»¶
- é…ç½®å…¨å±€æ’ä»¶å’ŒæŒ‡ä»¤

**å…³é”®ä»£ç ç¤ºä¾‹ï¼š**
```typescript
const app = createApp(App);
app.use(createPinia());
app.mount('#app');
```

#### `App.vue`
**ä½œç”¨ï¼š** åº”ç”¨çš„æ ¹ç»„ä»¶

**ä¸»è¦èŒè´£ï¼š**
- ç®¡ç†å…¨å±€çŠ¶æ€ï¼ˆç™»å½•çŠ¶æ€ã€æ´»åŠ¨ç»„ä»¶ï¼‰
- å¤„ç†å…¨å±€äº‹ä»¶ï¼ˆå³é”®èœå•ã€é”®ç›˜å¿«æ·é”®ï¼‰
- æä¾›å…¨å±€åˆ·æ–°åŠŸèƒ½
- å¸ƒå±€ç»“æ„ï¼ˆæ ‡é¢˜æ ã€ä¾§è¾¹æ ã€ä¸»å†…å®¹åŒºï¼‰

**ä¸»è¦åŠŸèƒ½ï¼š**
- å³é”®èœå•ï¼ˆåˆ·æ–°ã€å®˜ç½‘ã€å……å€¼ä¸­å¿ƒï¼‰
- å…¨å±€åˆ·æ–°æœºåˆ¶
- ç»„ä»¶åˆ‡æ¢é€»è¾‘
- ç­¾åˆ°åŠŸèƒ½é›†æˆ

---

## ğŸ¨ `src/renderer/assets/` - é™æ€èµ„æº

### ç›®å½•ç»“æ„
```
assets/
â”œâ”€â”€ avatar/              # é»˜è®¤ç”¨æˆ·å¤´åƒ
â”‚   â””â”€â”€ Avatar_def_01.png
â”œâ”€â”€ fonts/              # å­—ä½“æ–‡ä»¶
â”‚   â””â”€â”€ FZYaSongGBK.ttf
â”œâ”€â”€ item/               # æ¸¸æˆé“å…·å›¾æ ‡
â”‚   â””â”€â”€ DIAMOND_SHD.png
â”œâ”€â”€ json/               # é™æ€ JSON æ•°æ®
â”‚   â””â”€â”€ recruit.json     # å…¬æ‹›è®¡ç®—æ•°æ®
â”œâ”€â”€ subProfession/       # å¹²å‘˜èŒä¸šå›¾æ ‡
â”‚   â”œâ”€â”€ caster.svg
â”‚   â”œâ”€â”€ medic.svg
â”‚   â”œâ”€â”€ pioneer.svg
â”‚   â”œâ”€â”€ sniper.svg
â”‚   â”œâ”€â”€ special.svg
â”‚   â”œâ”€â”€ support.svg
â”‚   â”œâ”€â”€ tank.svg
â”‚   â””â”€â”€ warrior.svg
â”œâ”€â”€ 6x6dotspace.png    # èƒŒæ™¯çº¹ç†
â”œâ”€â”€ base.css            # åŸºç¡€æ ·å¼
â”œâ”€â”€ main.css            # ä¸»æ ·å¼æ–‡ä»¶
â”œâ”€â”€ logo_rhodes_island.svg  # ç½—å¾·å²› Logo
â”œâ”€â”€ icon_user.svg       # ç”¨æˆ·å›¾æ ‡
â”œâ”€â”€ icon_skland.svg    # æ£®ç©ºå²›å›¾æ ‡
â”œâ”€â”€ close.svg          # å…³é—­æŒ‰é’®å›¾æ ‡
â”œâ”€â”€ maximize.svg       # æœ€å¤§åŒ–æŒ‰é’®å›¾æ ‡
â”œâ”€â”€ minimize.svg       # æœ€å°åŒ–æŒ‰é’®å›¾æ ‡
â”œâ”€â”€ restore.svg        # è¿˜åŸæŒ‰é’®å›¾æ ‡
â””â”€â”€ wavy-lines.svg    # æ³¢æµªçº¿è£…é¥°
```

### ä¸»è¦èµ„æºè¯´æ˜

| èµ„æºç±»å‹ | ä½ç½® | ç”¨é€” |
|---------|--------|------|
| **å¤´åƒ** | `avatar/` | ç”¨æˆ·é»˜è®¤å¤´åƒ |
| **å­—ä½“** | `fonts/` | åº”ç”¨çš„ä¸­æ–‡å­—ä½“ |
| **é“å…·å›¾æ ‡** | `item/` | æ¸¸æˆå†…é“å…·å±•ç¤º |
| **èŒä¸šå›¾æ ‡** | `subProfession/` | å¹²å‘˜èŒä¸šåˆ†ç±»å›¾æ ‡ |
| **UIå›¾æ ‡** | æ ¹ç›®å½• | çª—å£æ§åˆ¶ã€ç”¨æˆ·ã€æ£®ç©ºå²›ç­‰ UI å…ƒç´  |
| **èƒŒæ™¯** | æ ¹ç›®å½• | é¡µé¢èƒŒæ™¯çº¹ç† |
| **æ ·å¼** | æ ¹ç›®å½• | å…¨å±€ CSS æ ·å¼ |
| **é™æ€æ•°æ®** | `json/` | å…¬æ‹›è®¡ç®—æ‰€éœ€çš„å¹²å‘˜æ ‡ç­¾æ•°æ® |

---

## ğŸ§© `src/renderer/components/` - Vue ç»„ä»¶

### ç»„ä»¶åˆ—è¡¨

| ç»„ä»¶å | å¤§å° | èŒè´£ | ä½¿ç”¨åœºæ™¯ |
|--------|------|--------|---------|
| `App.vue` | 28.3 KB | æ ¹ç»„ä»¶ï¼Œç®¡ç†å…¨å±€çŠ¶æ€å’Œå¸ƒå±€ | åº”ç”¨æ ¹ |
| `GameData.vue` | 36.85 KB | æ˜¾ç¤ºæ¸¸æˆæ•°æ®ï¼ˆç†æ™ºã€åŸºå»ºã€è‚‰é¸½ï¼‰ | æ¸¸æˆæ•°æ®é¡µé¢ |
| `Setting.vue` | 71.96 KB | ç”¨æˆ·è®¾ç½®å’Œä¿¡æ¯å±•ç¤º | è®¾ç½®é¡µé¢ |
| `Recruit.vue` | 20.26 KB | å…¬æ‹›æ ‡ç­¾è®¡ç®— | å…¬æ‹›è®¡ç®—é¡µé¢ |
| `Material.vue` | 117 B | ææ–™è®¡ç®—ï¼ˆå¾…å®ç°ï¼‰ | ææ–™è®¡ç®—é¡µé¢ |
| `headhuntingrecord.vue` | 96.92 KB | å¯»è®¿è®°å½•å±•ç¤º | å¯»è®¿è®°å½•é¡µé¢ |
| `LoginWindow.vue` | 28.67 KB | ç™»å½•å¼¹çª— | ç™»å½•æµç¨‹ |
| `TitleBar.vue` | 2.68 KB | è‡ªå®šä¹‰æ ‡é¢˜æ  | çª—å£é¡¶éƒ¨ |
| `ToastNotification.vue` | 3.88 KB | å…¨å±€é€šçŸ¥å¼¹çª— | æ¶ˆæ¯æç¤º |
| `UserCard.vue` | - | ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ï¼ˆæ–°å¢ï¼‰ | å¯å¤ç”¨ç»„ä»¶ |
| `AssistCharCard.vue` | - | åŠ©æˆ˜å¹²å‘˜å¡ç‰‡ï¼ˆæ–°å¢ï¼‰ | å¯å¤ç”¨ç»„ä»¶ |

### ç»„ä»¶è¯¦ç»†è¯´æ˜

#### `GameData.vue`
**åŠŸèƒ½æ¨¡å—ï¼š**
- å®æ—¶æ•°æ®å±•ç¤ºï¼ˆç†æ™ºã€åŸºå»ºä¿¡ä»»åº¦ã€è®¢å•ä¿¡æ¯ï¼‰
- å¹²å‘˜è®­ç»ƒæ•°æ®
- è‚‰é¸½æˆç»©å±•ç¤º
- æ‰‹åŠ¨åˆ·æ–°åŠŸèƒ½

**å…³é”®çŠ¶æ€ï¼š**
- `authStore` - è®¤è¯çŠ¶æ€
- `gameDataStore` - æ¸¸æˆæ•°æ®

#### `Setting.vue`
**åŠŸèƒ½æ¨¡å—ï¼š**
- ç”¨æˆ·ä¿¡æ¯å±•ç¤ºï¼ˆå¤´åƒã€æ˜µç§°ã€UIDï¼‰
- åŸºæœ¬ä¿¡æ¯ç»Ÿè®¡ï¼ˆä½œæˆ˜è¿›åº¦ã€å®¶å…·æ•°ã€å¹²å‘˜æ•°ã€æ—¶è£…æ•°ï¼‰
- åŠ©æˆ˜å¹²å‘˜å±•ç¤º
- æ—¥å¿—ç®¡ç†åŠŸèƒ½
- ç³»ç»ŸåŠŸèƒ½ï¼ˆæ£€æŸ¥æ›´æ–°ã€ä¸‹è½½é¡µé¢ï¼‰

#### `headhuntingrecord.vue`
**åŠŸèƒ½æ¨¡å—ï¼š**
- æŠ½å¡è®°å½•å±•ç¤º
- å¡æ± åˆ†ç±»åˆ‡æ¢
- è®°å½•ç­›é€‰
- æ—¶é—´èŒƒå›´é€‰æ‹©

#### `LoginWindow.vue`
**åŠŸèƒ½æ¨¡å—ï¼š**
- æ£®ç©ºå²›ç™»å½•
- æ‰‹æœºå·éªŒè¯ç ç™»å½•
- è§’è‰²é€‰æ‹©

#### `TitleBar.vue`
**åŠŸèƒ½æ¨¡å—ï¼š**
- è‡ªå®šä¹‰çª—å£æ ‡é¢˜æ 
- çª—å£æ§åˆ¶æŒ‰é’®ï¼ˆæœ€å°åŒ–ã€æœ€å¤§åŒ–ã€å…³é—­ï¼‰
- æ‹–æ‹½åŠŸèƒ½

#### `ToastNotification.vue`
**åŠŸèƒ½æ¨¡å—ï¼š**
- æˆåŠŸã€é”™è¯¯ã€è­¦å‘Šã€ä¿¡æ¯æç¤º
- è‡ªåŠ¨æ¶ˆå¤±
- å †å æ˜¾ç¤º

---

## ğŸ `src/renderer/composables/` - Vue ç»„åˆå¼å‡½æ•°

### ç›®å½•ç»“æ„
```
composables/
â”œâ”€â”€ useCopy.ts        # å¤åˆ¶åŠŸèƒ½
â”œâ”€â”€ useToast.ts       # Toast æç¤º
â””â”€â”€ useImage.ts      # å›¾ç‰‡å¤„ç†
```

### Composables è¯¦è§£

#### `useCopy.ts`
**ä½œç”¨ï¼š** å°è£…å¤åˆ¶åŠŸèƒ½ï¼Œæä¾›ä¾¿æ·çš„è°ƒç”¨æ–¹å¼

**å¯¼å‡ºå‡½æ•°ï¼š**
```typescript
{
  copyWithToast: (text: string, itemName: string) => Promise<boolean>  // å¸¦æç¤ºçš„å¤åˆ¶
  copySilent: (text: string, itemName: string) => Promise<boolean>   // é™é»˜å¤åˆ¶
}
```

**ä½¿ç”¨åœºæ™¯ï¼š**
- å¤åˆ¶ UIDã€æ˜µç§°ç­‰ç”¨æˆ·ä¿¡æ¯
- å¤åˆ¶æ—¥å¿—ã€ä»£ç ç­‰æ–‡æœ¬
- ä»»ä½•éœ€è¦å¤åˆ¶åŠŸèƒ½çš„åœºæ™¯

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```typescript
const { copyWithToast } = useCopy();
await copyWithToast('æ–‡æœ¬', 'UID');
```

#### `useToast.ts`
**ä½œç”¨ï¼š** ç»Ÿä¸€å°è£… toast æœåŠ¡

**å¯¼å‡ºå‡½æ•°ï¼š**
```typescript
{
  success: (message: string) => void    // æˆåŠŸæç¤º
  error: (message: string) => void      // é”™è¯¯æç¤º
  warning: (message: string) => void   // è­¦å‘Šæç¤º
  info: (message: string) => void      // ä¿¡æ¯æç¤º
}
```

**ä½¿ç”¨åœºæ™¯ï¼š**
- ä»»ä½•éœ€è¦æ˜¾ç¤ºæç¤ºçš„åœºæ™¯
- æ›¿ä»£ç›´æ¥è°ƒç”¨ toastServiceï¼Œæä¾›æ›´ç®€æ´çš„ API

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```typescript
const { success, error } = useToast();
success('æ“ä½œæˆåŠŸ');
error('æ“ä½œå¤±è´¥');
```

#### `useImage.ts`
**ä½œç”¨ï¼š** ç»Ÿä¸€å›¾ç‰‡åŠ è½½å’Œé”™è¯¯å¤„ç†

**å¯¼å‡ºå‡½æ•°ï¼š**
```typescript
{
  handleImageError: (charId: string, imageType: string, event: Event) => void
  handleImageLoad: (charId: string, imageType: string) => void
  processImageUrl: (url: string | undefined | null) => string
}
```

**ä½¿ç”¨åœºæ™¯ï¼š**
- å¹²å‘˜åŠèº«åƒåŠ è½½
- å¹²å‘˜å¤´åƒåŠ è½½
- æŠ€èƒ½å›¾æ ‡åŠ è½½
- ä»»ä½•å›¾ç‰‡èµ„æºçš„å¤„ç†

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```typescript
const { handleImageError } = useImage();
<img @error="(e) => handleImageError(charId, 'portrait', e)" />
```

---

## ğŸ”§ `src/renderer/services/` - ä¸šåŠ¡æœåŠ¡

### ç›®å½•ç»“æ„
```
services/
â”œâ”€â”€ api.ts          # æ£®ç©ºå²› API å°è£…
â”œâ”€â”€ Gacha.ts        # å¯»è®¿è®°å½• API
â”œâ”€â”€ logger.ts       # æ—¥å¿—æœåŠ¡
â”œâ”€â”€ toastService.ts  # æç¤ºé€šçŸ¥æœåŠ¡
â””â”€â”€ updater.ts      # æ›´æ–°æœåŠ¡
```

### æœåŠ¡è¯¦è§£

#### `api.ts` - æ£®ç©ºå²› API
**ä½œç”¨ï¼š** å°è£…æ‰€æœ‰ä¸æ£®ç©ºå²›æœåŠ¡å™¨çš„äº¤äº’

**ä¸»è¦æ¥å£ï¼š**
| å‡½æ•°å | ä½œç”¨ | è¯·æ±‚æ–¹æ³• |
|--------|------|---------|
| `sendSmsCode` | å‘é€éªŒè¯ç  | POST |
| `loginWithSms` | æ‰‹æœºå·ç™»å½• | POST |
| `getBindingRoles` | è·å–ç»‘å®šè§’è‰²åˆ—è¡¨ | GET |
| `getPlayerData` | è·å–ç©å®¶æ•°æ® | GET |
| `checkCred` | æ£€æŸ¥ Cred æœ‰æ•ˆæ€§ | GET |
| `attendance` | æ£®ç©ºå²›ç­¾åˆ° | POST |

**ç­¾åæœºåˆ¶ï¼š**
- ä½¿ç”¨ `getSignedHeaders()` ç”Ÿæˆè¯·æ±‚å¤´
- åŒ…å«æ—¶é—´æˆ³ã€ç­¾åã€è®¾å¤‡ ID ç­‰å‚æ•°
- ç¡®ä¿è¯·æ±‚çš„å®‰å…¨æ€§

#### `Gacha.ts` - å¯»è®¿è®°å½• API
**ä½œç”¨ï¼š** å¤„ç†æŠ½å¡è®°å½•çš„è·å–

**ä¸»è¦æ¥å£ï¼š**
| å‡½æ•°å | ä½œç”¨ |
|--------|------|
| `getGachaCategories` | è·å–å¡æ± åˆ†ç±» |
| `getGachaHistory` | è·å–æŠ½å¡è®°å½• |
| `getCharacterLogin` | è§’è‰²ç™»å½•ï¼ˆè·å– cookieï¼‰ |

**ç‰¹ç‚¹ï¼š**
- é€šè¿‡æ¸¸æˆæœåŠ¡å™¨è·å–æ•°æ®
- æ”¯æŒåˆ†é¡µæŸ¥è¯¢
- è‡ªåŠ¨å¤„ç† cookie

#### `logger.ts` - æ—¥å¿—æœåŠ¡
**ä½œç”¨ï¼š** ç»Ÿä¸€ç®¡ç†åº”ç”¨æ—¥å¿—

**ä¸»è¦åŠŸèƒ½ï¼š**
- æ—¥å¿—çº§åˆ«æ§åˆ¶ï¼ˆdebugã€infoã€warnã€errorï¼‰
- æ—¥å¿—å­˜å‚¨ï¼ˆæœ€å¤š 500 æ¡ï¼‰
- æ—¥å¿—å¯¼å‡ºï¼ˆæ–‡æœ¬ã€JSON æ ¼å¼ï¼‰
- æ—¥å¿—æ¸…é™¤

**ä½¿ç”¨åœºæ™¯ï¼š**
- è®°å½•ç”¨æˆ·æ“ä½œ
- è®°å½• API è¯·æ±‚/å“åº”
- è®°å½•é”™è¯¯ä¿¡æ¯
- é—®é¢˜æ’æŸ¥å’Œåé¦ˆ

#### `toastService.ts` - æç¤ºé€šçŸ¥æœåŠ¡
**ä½œç”¨ï¼š** å…¨å±€æç¤ºé€šçŸ¥ç®¡ç†

**ä¸»è¦åŠŸèƒ½ï¼š**
- æˆåŠŸã€é”™è¯¯ã€è­¦å‘Šã€ä¿¡æ¯å››ç§æç¤º
- è‡ªåŠ¨é˜Ÿåˆ—ç®¡ç†ï¼ˆé¿å…é‡å¤æç¤ºï¼‰
- è‡ªåŠ¨æ¶ˆå¤±ï¼ˆå¯é…ç½®æ—¶é—´ï¼‰
- æ”¯æŒç‚¹å‡»å…³é—­

**æç¤ºç±»å‹ï¼š**
- `showSuccess()` - ç»¿è‰²æˆåŠŸæç¤º
- `showError()` - çº¢è‰²é”™è¯¯æç¤º
- `showWarning()` - æ©™è‰²è­¦å‘Šæç¤º
- `showInfo()` - è“è‰²ä¿¡æ¯æç¤º

#### `updater.ts` - æ›´æ–°æœåŠ¡
**ä½œç”¨ï¼š** æ£€æŸ¥å’Œç®¡ç†åº”ç”¨æ›´æ–°

**ä¸»è¦åŠŸèƒ½ï¼š**
- æ£€æŸ¥ GitHub Releases
- ç‰ˆæœ¬å¯¹æ¯”
- æ˜¾ç¤ºæ›´æ–°å¯¹è¯æ¡†
- æ‰“å¼€ä¸‹è½½é¡µé¢

**æ›´æ–°æµç¨‹ï¼š**
```
æ£€æŸ¥æ›´æ–°
  â†“
è·å–æœ€æ–°ç‰ˆæœ¬å·
  â†“
å¯¹æ¯”å½“å‰ç‰ˆæœ¬
  â†“
æœ‰æ–°ç‰ˆæœ¬ï¼Ÿâ†’ æ˜¾ç¤ºæ›´æ–°å¯¹è¯æ¡†
  â†“
ç”¨æˆ·ç¡®è®¤ â†’ æ‰“å¼€ä¸‹è½½é¡µé¢
```

---

## ğŸ—„ `src/renderer/stores/` - çŠ¶æ€ç®¡ç†

### ç›®å½•ç»“æ„
```
stores/
â”œâ”€â”€ auth.ts       # è®¤è¯çŠ¶æ€ç®¡ç†
â””â”€â”€ gameData.ts  # æ¸¸æˆæ•°æ®çŠ¶æ€ç®¡ç†
```

### Store è¯¦è§£

#### `auth.ts` - è®¤è¯çŠ¶æ€
**ä½œç”¨ï¼š** ç®¡ç†ç”¨æˆ·è®¤è¯ç›¸å…³çš„çŠ¶æ€

**ä¸»è¦çŠ¶æ€ï¼š**
```typescript
{
  isLogin: boolean           // æ˜¯å¦å·²ç™»å½•
  userName: string          // ç”¨æˆ·æ˜µç§°
  hgToken: string          // é¹°è§’ç½‘ç»œ token
  sklandCred: string       // æ£®ç©ºå²›å‡­è¯
  sklandSignToken: string  // æ£®ç©ºå²›ç­¾å token
  bindingRoles: array      // ç»‘å®šçš„è§’è‰²åˆ—è¡¨
  playerData: object      // ç©å®¶æ•°æ®
  isInitializing: boolean  // æ˜¯å¦æ­£åœ¨åˆå§‹åŒ–
  isRestoring: boolean     // æ˜¯å¦æ­£åœ¨æ¢å¤ç™»å½•çŠ¶æ€
}
```

**ä¸»è¦æ–¹æ³•ï¼š**
- `loginWithSms()` - æ‰‹æœºå·ç™»å½•
- `restoreAuthState()` - æ¢å¤ç™»å½•çŠ¶æ€
- `fetchBindingRoles()` - è·å–ç»‘å®šè§’è‰²
- `logout()` - é€€å‡ºç™»å½•
- `saveToLocalStorage()` - ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
- `loadFromLocalStorage()` - ä»æœ¬åœ°å­˜å‚¨åŠ è½½

**æ•°æ®æŒä¹…åŒ–ï¼š**
- ä½¿ç”¨ `localStorage` å­˜å‚¨
- ç™»å½•çŠ¶æ€åœ¨åº”ç”¨é‡å¯åæ¢å¤
- è‡ªåŠ¨å¤„ç† token è¿‡æœŸ

#### `gameData.ts` - æ¸¸æˆæ•°æ®çŠ¶æ€
**ä½œç”¨ï¼š** ç®¡ç†æ¸¸æˆç›¸å…³çš„æ•°æ®å’ŒçŠ¶æ€

**ä¸»è¦çŠ¶æ€ï¼š**
```typescript
{
  playerData: object        // ç©å®¶å®Œæ•´æ•°æ®
  userAvatar: string       // ç”¨æˆ·å¤´åƒ URL
  gameUid: string         // æ¸¸æˆ UID
  userLevel: number       // ç”¨æˆ·ç­‰çº§
  isLoading: boolean      // æ˜¯å¦æ­£åœ¨åŠ è½½
  isRefreshing: boolean   // æ˜¯å¦æ­£åœ¨åˆ·æ–°
  errorMsg: string        // é”™è¯¯ä¿¡æ¯
  dataCache: object      // æ•°æ®ç¼“å­˜
  currentTime: number    // å½“å‰æ—¶é—´ï¼ˆç§’ï¼‰
}
```

**ä¸»è¦æ–¹æ³•ï¼š**
- `fetchGameData()` - è·å–æ¸¸æˆæ•°æ®
- `refreshData()` - å¼ºåˆ¶åˆ·æ–°æ•°æ®
- `formatTimestamp()` - æ ¼å¼åŒ–æ—¶é—´æˆ³
- `formatRecoveryTime()` - æ ¼å¼åŒ–æ¢å¤æ—¶é—´
- `fetchUserAvatar()` - è·å–ç”¨æˆ·å¤´åƒ
- `handleAvatarError()` - å¤„ç†å¤´åƒåŠ è½½é”™è¯¯
- `calculateOperatorBuff()` - è®¡ç®—å¹²å‘˜åŠ æˆ
- `calculateBuildingEfficiency()` - è®¡ç®—åŸºå»ºæ•ˆç‡
- `getAssistCharArrayStatus()` - è·å–åŠ©æˆ˜å¹²å‘˜æ•°ç»„
- `getRogueList()` - è·å–è‚‰é¸½åˆ—è¡¨

**æ•°æ®ç»“æ„ï¼š**
- åŒ…å«ç†æ™ºã€åŸºå»ºã€è®­ç»ƒã€è‚‰é¸½ç­‰æ‰€æœ‰æ¸¸æˆæ•°æ®
- è‡ªåŠ¨è®¡ç®—å¹¶æ ¼å¼åŒ–å±•ç¤ºæ•°æ®
- æ”¯æŒæ•°æ®ç¼“å­˜ï¼ˆ5åˆ†é’Ÿæœ‰æ•ˆæœŸï¼‰

---

## ğŸ¨ `src/renderer/styles/` - å…¨å±€æ ·å¼

### ç›®å½•ç»“æ„
```
styles/
â””â”€â”€ common.css    # é€šç”¨å¯å¤ç”¨æ ·å¼
```

### `common.css` è¯¦è§£
**ä½œç”¨ï¼š** æä¾›å¯å¤ç”¨çš„ CSS ç±»å’Œå·¥å…·ç±»

**ä¸»è¦æ ·å¼ç±»åˆ«ï¼š**

#### å¡ç‰‡æ ·å¼
```css
.card { /* é€šç”¨å¡ç‰‡ */ }
```

#### æŒ‰é’®æ ·å¼
```css
.btn { /* é€šç”¨æŒ‰é’® */ }
.btn:hover { /* æ‚¬åœæ•ˆæœ */ }
.btn:disabled { /* ç¦ç”¨çŠ¶æ€ */ }
```

#### è¾“å…¥æ¡†æ ·å¼
```css
.input { /* é€šç”¨è¾“å…¥æ¡† */ }
.input:focus { /* èšç„¦çŠ¶æ€ */ }
```

#### åŠ è½½åŠ¨ç”»
```css
@keyframes spin { /* æ—‹è½¬åŠ¨ç”» */ }
.loading-spinner { /* åŠ è½½å›¾æ ‡ */ }
```

#### æ»šåŠ¨æ¡æ ·å¼
```css
.scrollbar-custom { /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */ }
```

#### å·¥å…·ç±»
```css
.flex-center { /* å±…ä¸­ flex */ }
.flex-between { /* ä¸¤ç«¯å¯¹é½ flex */ }
.gap-sm { /* å°é—´è· */ }
.text-ellipsis { /* æ–‡æœ¬çœç•¥ */ }
```

**ä½¿ç”¨åœºæ™¯ï¼š**
- å¿«é€Ÿæ„å»º UI
- ä¿æŒæ ·å¼ä¸€è‡´æ€§
- å‡å°‘é‡å¤ä»£ç 

---

## ğŸ·ï¸ `src/renderer/types/` - ç±»å‹å®šä¹‰

### ç›®å½•ç»“æ„
```
types/
â””â”€â”€ components.ts    # ç»„ä»¶é€šç”¨ç±»å‹
```

### `components.ts` è¯¦è§£
**ä½œç”¨ï¼š** å®šä¹‰ç»„ä»¶é—´å…±äº«çš„ TypeScript ç±»å‹

**ä¸»è¦ç±»å‹ï¼š**

```typescript
// å¡ç‰‡æ•°æ®é¡¹
export interface DataItem {
  label: string;
  value: string | number;
}

// èœå•é¡¹
export interface MenuItem {
  label: string;
  action: string;
  icon?: string;
  disabled?: boolean;
}

// åˆ†é¡µä¿¡æ¯
export interface PaginationInfo {
  current: number;
  total: number;
  pageSize: number;
  hasMore: boolean;
}

// åŠ è½½çŠ¶æ€
export interface LoadingState {
  isLoading: boolean;
  isRefreshing: boolean;
  error: string | null;
}

// è¡¨å•éªŒè¯ç»“æœ
export interface ValidationResult {
  isValid: boolean;
  errors: Record<string, string>;
}
```

**ä½¿ç”¨åœºæ™¯ï¼š**
- Props ç±»å‹å®šä¹‰
- ç»„ä»¶é—´é€šä¿¡
- æ•°æ®ç»“æ„çº¦æŸ
- å‡å°‘ any ç±»å‹ä½¿ç”¨

---

## ğŸ› ï¸ `src/renderer/utils/` - å·¥å…·å‡½æ•°

### ç›®å½•ç»“æ„
```
utils/
â”œâ”€â”€ api/              # API ç›¸å…³å·¥å…·
â”‚   â”œâ”€â”€ security.ts   # ç­¾åç”Ÿæˆ
â”‚   â””â”€â”€ types.ts      # API ç±»å‹
â”œâ”€â”€ copy.ts           # å¤åˆ¶åŠŸèƒ½
â”œâ”€â”€ date.ts           # æ—¥æœŸæ—¶é—´å¤„ç†
â””â”€â”€ validator.ts      # æ•°æ®éªŒè¯
```

### å·¥å…·å‡½æ•°è¯¦è§£

#### `api/security.ts`
**ä½œç”¨ï¼š** API è¯·æ±‚ç­¾åç”Ÿæˆ

**ä¸»è¦å‡½æ•°ï¼š**
- `getSignedHeaders()` - ç”Ÿæˆå¸¦ç­¾åçš„è¯·æ±‚å¤´
- `generateSignature()` - ç”Ÿæˆè¯·æ±‚ç­¾å
- `getDId()` - è·å–è®¾å¤‡ ID
- `generateMockDId()` - ç”Ÿæˆæ¨¡æ‹Ÿè®¾å¤‡ ID

**ç­¾åæµç¨‹ï¼š**
```
è¯·æ±‚å‚æ•°
  â†“
+ æ—¶é—´æˆ³ + è®¾å¤‡ ID + ç‰ˆæœ¬å·
  â†“
+ token + path + body/query
  â†“
ç”Ÿæˆ MD5 ç­¾å
  â†“
æ·»åŠ åˆ°è¯·æ±‚å¤´
```

#### `api/types.ts`
**ä½œç”¨ï¼š** API ç›¸å…³çš„ç±»å‹å®šä¹‰

**ä¸»è¦ç±»å‹ï¼š**
- `ApiResponse` - API å“åº”åŸºç¡€ç±»å‹
- `HypergryphAccountResponse` - é¹°è§’è´¦å·å“åº”
- `SmsCodeResponse` - çŸ­ä¿¡éªŒè¯ç å“åº”
- `LoginResponse` - ç™»å½•å“åº”
- `BindingCharacter` - ç»‘å®šè§’è‰²
- `PlayerData` - ç©å®¶æ•°æ®

#### `copy.ts`
**ä½œç”¨ï¼š** é«˜å¯é æ€§çš„å¤åˆ¶åˆ°å‰ªè´´æ¿åŠŸèƒ½

**ç‰¹ç‚¹ï¼š**
- ä¸‰ç§å¤åˆ¶æ–¹æ³•ï¼ˆClipboard APIã€execCommandã€contenteditableï¼‰
- è‡ªåŠ¨é™çº§å¤„ç†
- è·¨æµè§ˆå™¨å…¼å®¹

**ä¸»è¦å‡½æ•°ï¼š**
```typescript
copyToClipboard(
  text: string,      // è¦å¤åˆ¶çš„æ–‡æœ¬
  itemName: string    // å¤åˆ¶é¡¹åç§°ï¼ˆç”¨äºæ—¥å¿—ï¼‰
): Promise<boolean>  // è¿”å›æ˜¯å¦æˆåŠŸ
```

**ä½¿ç”¨åœºæ™¯ï¼š**
- å¤åˆ¶ UIDã€æ˜µç§°
- å¤åˆ¶æ—¥å¿—å†…å®¹
- ä»»ä½•éœ€è¦å¤åˆ¶æ–‡æœ¬çš„åœºæ™¯

#### `date.ts`
**ä½œç”¨ï¼š** æ—¥æœŸæ—¶é—´æ ¼å¼åŒ–å·¥å…·

**ä¸»è¦å‡½æ•°ï¼š**
```typescript
// æ—¶é—´æˆ³è½¬æ—¥æœŸå­—ç¬¦ä¸²
formatTimestamp(timestamp: number): string

// æ ¼å¼åŒ–æ¢å¤æ—¶é—´
formatRecoveryTime(timestamp: number): string

// ç§’æ•°è½¬æ—¶é—´æ ¼å¼
formatSeconds(seconds: number): string
```

**ä½¿ç”¨åœºæ™¯ï¼š**
- æ˜¾ç¤ºç†æ™ºæ¢å¤æ—¶é—´
- æ˜¾ç¤ºæ³¨å†Œæ—¶é—´
- æ˜¾ç¤ºä»»æ„æ—¶é—´æˆ³
- æ ¼å¼åŒ–æ¸¸æˆæ—¶é•¿

#### `validator.ts`
**ä½œç”¨ï¼š** æ•°æ®éªŒè¯å·¥å…·

**ä¸»è¦å‡½æ•°ï¼š**
```typescript
// URL éªŒè¯
isValidUrl(url: string): boolean

// é‚®ç®±éªŒè¯
isValidEmail(email: string): boolean

// æ‰‹æœºå·éªŒè¯
isValidPhone(phone: string): boolean

// ç©ºå­—ç¬¦ä¸²æ£€æŸ¥
isEmptyString(str: string): boolean

// æ•°å­—èŒƒå›´éªŒè¯
isNumberInRange(num: number, min: number, max: number): boolean
```

**ä½¿ç”¨åœºæ™¯ï¼š**
- è¡¨å•éªŒè¯
- è¾“å…¥æ£€æŸ¥
- æ•°æ®è¿‡æ»¤
- é˜²æ­¢æ— æ•ˆæ•°æ®

---

## ğŸ§ª `src/renderer/test/` - æµ‹è¯•æ–‡ä»¶

### ç›®å½•ç»“æ„
```
test/
â””â”€â”€ logger_test.html    # æ—¥å¿—åŠŸèƒ½æµ‹è¯•é¡µé¢
```

### `logger_test.html`
**ä½œç”¨ï¼š** æµ‹è¯•æ—¥å¿—æœåŠ¡çš„åŠŸèƒ½

**æµ‹è¯•å†…å®¹ï¼š**
- æ—¥å¿—è®°å½•
- æ—¥å¿—å¯¼å‡º
- æ—¥å¿—æ¸…é™¤

**ä½¿ç”¨åœºæ™¯ï¼š**
- å¼€å‘æ—¶æµ‹è¯•æ—¥å¿—åŠŸèƒ½
- éªŒè¯æ—¥å¿—æœåŠ¡æ­£å¸¸å·¥ä½œ

---

## ğŸ”§ é…ç½®æ–‡ä»¶è¯´æ˜

### `package.json`
**ä½œç”¨ï¼š** Node.js é¡¹ç›®é…ç½®æ–‡ä»¶

**ä¸»è¦é…ç½®ï¼š**
- é¡¹ç›®å…ƒæ•°æ®ï¼ˆåç§°ã€ç‰ˆæœ¬ã€æè¿°ï¼‰
- ä¾èµ–åŒ…ç®¡ç†ï¼ˆdependenciesã€devDependenciesï¼‰
- è„šæœ¬å‘½ä»¤ï¼ˆscriptsï¼‰
- é¡¹ç›®é…ç½®

**ä¸»è¦è„šæœ¬ï¼š**
```json
{
  "dev": "vite",                    // å¼€å‘æ¨¡å¼
  "build": "electron-vite build",   // æ„å»º
  "build:win": "electron-builder",  // Windows æ‰“åŒ…
  "preview": "electron-vite preview", // é¢„è§ˆ
  "typecheck": "tsc"              // ç±»å‹æ£€æŸ¥
}
```

### `tsconfig.json`
**ä½œç”¨ï¼š** TypeScript ç¼–è¯‘é…ç½®

**ä¸»è¦é…ç½®ï¼š**
- ç¼–è¯‘ç›®æ ‡ï¼ˆES ç‰ˆæœ¬ï¼‰
- æ¨¡å—ç³»ç»Ÿï¼ˆESNextï¼‰
- è·¯å¾„åˆ«åï¼ˆ@ æ˜ å°„ï¼‰
- ä¸¥æ ¼æ¨¡å¼å¼€å…³

### `vite.config.ts`
**ä½œç”¨ï¼š** Vite æ„å»ºå·¥å…·é…ç½®

**ä¸»è¦é…ç½®ï¼š**
- æ’ä»¶é…ç½®
- è·¯å¾„åˆ«å
- æ„å»ºä¼˜åŒ–
- å¼€å‘æœåŠ¡å™¨é…ç½®

### `electron-builder.yml`
**ä½œç”¨ï¼š** Electron åº”ç”¨æ‰“åŒ…é…ç½®

**ä¸»è¦é…ç½®ï¼š**
- åº”ç”¨å…ƒæ•°æ®ï¼ˆåç§°ã€å›¾æ ‡ã€ç‰ˆæœ¬ï¼‰
- æ„å»ºç›®æ ‡ï¼ˆWindowsã€macOSã€Linuxï¼‰
- æ–‡ä»¶å…³è”
- å®‰è£…ç¨‹åºé…ç½®

---

## ğŸ”„ æ•°æ®æµå‘å›¾

```
ç”¨æˆ·æ“ä½œ
    â†“
Vue ç»„ä»¶
    â†“
Pinia Store
    â†“
Services (API å±‚ï¼‰
    â†“
Electron IPC / ç›´æ¥ Fetch
    â†“
æœåŠ¡å™¨å“åº”
    â†“
Store æ›´æ–°
    â†“
ç»„ä»¶é‡æ–°æ¸²æŸ“
```

---

## ğŸ” å®‰å…¨æœºåˆ¶

### 1. API ç­¾å
- æ‰€æœ‰ API è¯·æ±‚éƒ½éœ€è¦ç­¾å
- ç­¾ååŸºäºæ—¶é—´æˆ³ã€tokenã€è¯·æ±‚å‚æ•°
- é˜²æ­¢è¯·æ±‚è¢«ç¯¡æ”¹

### 2. IPC å®‰å…¨
- ä½¿ç”¨ ContextBridge æš´éœ²å—é™ API
- é¢„åŠ è½½è„šæœ¬éš”ç¦»ä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹
- é˜²æ­¢æ¸²æŸ“è¿›ç¨‹ç›´æ¥è®¿é—®ä¸»è¿›ç¨‹

### 3. æ•°æ®æŒä¹…åŒ–
- ä½¿ç”¨ localStorage åŠ å¯†å­˜å‚¨æ•æ„Ÿä¿¡æ¯
- Token è‡ªåŠ¨åˆ·æ–°æœºåˆ¶
- ç™»å½•çŠ¶æ€æ¢å¤éªŒè¯

---

## ğŸ¯ å¼€å‘å»ºè®®

### 1. ç»„ä»¶å¼€å‘
- ä¿æŒç»„ä»¶å•ä¸€èŒè´£
- ä½¿ç”¨ TypeScript ç±»å‹
- æå–å¯å¤ç”¨é€»è¾‘åˆ° composables
- ç»„ä»¶å¤§å°æ§åˆ¶åœ¨ 500 è¡Œä»¥å†…

### 2. çŠ¶æ€ç®¡ç†
- å°†å…±äº«çŠ¶æ€æ”¾åœ¨ Store
- ä½¿ç”¨è®¡ç®—å±æ€§æ´¾ç”Ÿæ•°æ®
- é¿å…æ·±å±‚åµŒå¥—çŠ¶æ€

### 3. API è°ƒç”¨
- ç»Ÿä¸€ä½¿ç”¨ services å±‚
- ç»Ÿä¸€é”™è¯¯å¤„ç†
- ä½¿ç”¨ logger è®°å½•è¯·æ±‚

### 4. æ ·å¼ç®¡ç†
- ä½¿ç”¨ common.css ä¸­çš„é€šç”¨æ ·å¼
- ä¿æŒæ ·å¼ä¸€è‡´æ€§
- é¿å…å†…è”æ ·å¼

### 5. ç±»å‹å®‰å…¨
- å……åˆ†åˆ©ç”¨ TypeScript ç±»å‹æ¨å¯¼
- é¿å…ä½¿ç”¨ any
- ä½¿ç”¨æ¥å£å®šä¹‰æ•°æ®ç»“æ„

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. ç»„ä»¶ä¼˜åŒ–
- ä½¿ç”¨ `v-once` å¤„ç†é™æ€å†…å®¹
- ä½¿ç”¨ `v-show` ä»£æ›¿ `v-if` é¢‘ç¹åˆ‡æ¢
- åˆç†ä½¿ç”¨ `computed` ç¼“å­˜è®¡ç®—ç»“æœ

### 2. è¯·æ±‚ä¼˜åŒ–
- å®ç°è¯·æ±‚é˜²æŠ–
- ä½¿ç”¨æ•°æ®ç¼“å­˜
- åˆå¹¶æ‰¹é‡è¯·æ±‚

### 3. æ¸²æŸ“ä¼˜åŒ–
- ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨å¤„ç†é•¿åˆ—è¡¨
- å›¾ç‰‡æ‡’åŠ è½½
- é¿å…ä¸å¿…è¦çš„å“åº”å¼æ•°æ®

---

## ğŸš€ æ‰©å±•æŒ‡å—

### æ·»åŠ æ–°é¡µé¢
1. åœ¨ `components/` åˆ›å»ºæ–°ç»„ä»¶
2. åœ¨ `App.vue` çš„å¯¼èˆªèœå•æ·»åŠ å…¥å£
3. åœ¨ `componentMap` æ³¨å†Œç»„ä»¶

### æ·»åŠ æ–° API
1. åœ¨ `services/api.ts` æ·»åŠ æ¥å£å‡½æ•°
2. åœ¨ `api/types.ts` æ·»åŠ ç±»å‹å®šä¹‰
3. åœ¨ Store ä¸­è°ƒç”¨æ–° API

### æ·»åŠ æ–° Composable
1. åœ¨ `composables/` åˆ›å»ºæ–‡ä»¶
2. å¯¼å‡ºå‡½æ•°
3. åœ¨ç»„ä»¶ä¸­å¯¼å…¥ä½¿ç”¨

---

## ğŸ“ æ€»ç»“

æœ¬æ¶æ„è®¾è®¡çš„æ ¸å¿ƒåŸåˆ™ï¼š

1. **åˆ†å±‚æ¸…æ™°** - UIã€ä¸šåŠ¡é€»è¾‘ã€æ•°æ®è®¿é—®åˆ†ç¦»
2. **ä»£ç å¤ç”¨** - ç»„ä»¶ã€å·¥å…·å‡½æ•°ã€æ ·å¼å¯å¤ç”¨
3. **ç±»å‹å®‰å…¨** - å……åˆ†åˆ©ç”¨ TypeScript
4. **æ˜“äºç»´æŠ¤** - æ¨¡å—åŒ–ã€èŒè´£å•ä¸€
5. **å¯æ‰©å±•æ€§** - æ˜“äºæ·»åŠ æ–°åŠŸèƒ½

éµå¾ªè¿™äº›åŸåˆ™ï¼Œå¯ä»¥æ„å»ºå‡ºé«˜è´¨é‡ã€æ˜“ç»´æŠ¤çš„ Electron + Vue åº”ç”¨ï¼
